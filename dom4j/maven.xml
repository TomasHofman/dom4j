<project default="java:jar" 
         xmlns:ant="jelly:ant"
         xmlns:maven="jelly:maven" >

    <!-- define the classpath used to run examples -->
    <goal name="create-classpath" prereqs="java:compile,test:compile">
        <path id="test.classpath">
            <pathelement path="${maven.build.dest}"/>
            <pathelement path="target/classes"/>
            <pathelement path="target/test-classes"/>
            <pathelement path="src/"/>
            <path refid="maven.dependency.classpath"/>
        </path>
    </goal>

    <postGoal name="dist:prepare-bin-filesystem">
        <ant:copy todir="${maven.dist.bin.assembly.dir}/src">
            <fileset dir="src"/>
        </ant:copy>
        <ant:copy todir="${maven.dist.bin.assembly.dir}/lib">
            <fileset dir="lib"/>
        </ant:copy>
    </postGoal>

    <postGoal name="dist:prepare-src-filesystem">
        <ant:copy todir="${maven.dist.src.assembly.dir}/lib">
            <fileset dir="lib"/>
        </ant:copy>
    </postGoal>

    <preGoal name="test:test">
        <ant:property name="test.dest"
            value="${pom.getPluginContext('maven-test-plugin').getVariable('maven.test.dest')}"/>

        <ant:path id="test.extra.classpath">
            <pathelement location="."/>
        </ant:path>

        <maven:addPath id="maven.dependency.classpath"
                       refid="test.extra.classpath"/>
    </preGoal>

    <preGoal name="site">
        <attainGoal name="docbook:transform"/>
    </preGoal>

    <preGoal name="xdoc:jelly-transform">
        <attainGoal name="faq"/>
    </preGoal>

    <postGoal name="xdoc:register-reports">
        <attainGoal name="maven-checkstyle-plugin:deregister"/>  
    </postGoal>

</project>
