<project default="java:jar" 
         xmlns:ant="jelly:ant"
         xmlns:maven="jelly:maven" >

    <!-- define the classpath used to run examples -->
    <goal name="create-classpath" prereqs="java:compile,test:compile">
        <path id="test.classpath">
            <pathelement path="${maven.build.dest}"/>
            <pathelement path="target/classes"/>
            <pathelement path="target/test-classes"/>
            <pathelement path="src/"/>
            <path refid="maven.dependency.classpath"/>
        </path>
    </goal>

    <preGoal name="test:test">
        <ant:property name="test.dest"
            value="${pom.getPluginContext('maven-test-plugin').getVariable('maven.test.dest')}"/>

        <ant:path id="test.extra.classpath">
            <pathelement location="."/>
        </ant:path>

        <maven:addPath id="maven.dependency.classpath"
                       refid="test.extra.classpath"/>
    </preGoal>

    <preGoal name="site:deploy">
        <attainGoal name="docbook:transform"/>
    </preGoal>

    <preGoal name="xdoc:jelly-transform">
        <attainGoal name="faq"/>
    </preGoal>  

</project>
